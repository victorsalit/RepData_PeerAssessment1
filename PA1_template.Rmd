---
title: 'Reproducible Research: Peer Assessment 1'
author: "Victor Salit"
output:
  html_document:
    fig_caption: yes
    keep_md: yes
    toc: yes
---


## Loading and preprocessing the data
```{r, cache=TRUE}
data <- read.csv(unz("activity.zip", "activity.csv"),stringsAsFactors = FALSE)
```

```{r}
data$date <- as.Date(data$date)
str(data)
summary(data)
head(data)
tail(data)
```


## What is mean total number of steps taken per day?
```{r}
completedata <- data[complete.cases(data$step),]
summary(completedata)
head(completedata)
tail(completedata)
by1 <- factor(completedata$date)
total_steps <- aggregate(completedata$steps, by=list(by1), sum, simplify = TRUE)
names(total_steps) <- c("date", "steps")
hist(total_steps$steps, col="blue")
meansteps <- mean(total_steps$steps)
mediansteps <- median(total_steps$steps)
```
The mean total number of steps taken per day is `r meansteps`.  
The median total number of steps taken per day is `r mediansteps`.

## What is the average daily activity pattern?
```{r}
by2 <- factor(completedata$interval)
averageactivity <- aggregate(completedata$steps, by=list(by2),mean,simplify=TRUE)
names(averageactivity) <- c("interval", "mean_steps")
plot(as.character(averageactivity$interval),averageactivity$mean_steps,type="l")
maxinterval <- averageactivity$interval[which.max(averageactivity$mean_steps)]
```
On average across all the days in the dataset the interval `r maxinterval` contains the maximum number of steps.

## Imputing missing values
```{r}
NAs <- sum(is.na(data$steps))
```

The total number of missing values in the dataset is `r NAs`.  
Strategy for filling the missing data: interval mean across all days:

```{r}
filled <- data

index <- match(data$interval[is.na(data$steps)], averageactivity$interval)
filled$steps[is.na(data$steps)] <- averageactivity[index,2]

```



## Are there differences in activity patterns between weekdays and weekends?
